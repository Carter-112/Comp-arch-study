<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Interactive Quiz</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    #quiz-container { max-width: 600px; margin: auto; }
    #question { font-size: 1.2em; margin-bottom: 1em; }
    .option {
      border: 2px solid #ccc;
      border-radius: 4px;
      padding: 0.5em;
      margin-bottom: 0.5em;
      cursor: pointer;
    }
    .option.correct { border-color: green; }
    .option.wrong   { border-color: red; }
    #next-btn {
      margin-top: 1em;
      padding: 0.5em 1em;
      font-size: 1em;
    }
  </style>
</head>
<body>
  <div id="quiz-container">
    <h1>Quiz</h1>
    <div id="question"></div>
    <div id="options"></div>
    <button id="next-btn" disabled>Next</button>
  </div>

  <script>
    (async function() {
      const raw = await fetch('quiz.txt').then(r => r.text());
      const [qBlock, aBlock] = raw.split('Answer Key');
      const questionLines = qBlock.trim().split('\n\n');
      const answerLines = aBlock.trim().split('\n');
      const answers = {};
      answerLines.forEach(line => {
        const [num, ans] = line.split('.');
        answers[+num.trim()] = ans.trim();
      });

      const questions = questionLines.map(block => {
        const lines = block.split('\n');
        const header = lines.shift();
        const [, text] = header.match(/^\s*\d+\.\s*(.+)$/);
        const opts = lines.map(l => {
          const letter = l[0];
          const content = l.slice(3);
          return { letter, content };
        });
        const num = +header.match(/^\s*(\d+)\./)[1];
        return { num, text, opts };
      });

      let idx = 0, correctCount = 0;
      const qEl = document.getElementById('question');
      const oEl = document.getElementById('options');
      const btn = document.getElementById('next-btn');

      function showQuestion() {
        btn.disabled = true;
        oEl.innerHTML = '';
        const q = questions[idx];
        qEl.textContent = `${q.num}. ${q.text}`;
        q.opts.forEach(o => {
          const div = document.createElement('div');
          div.className = 'option';
          div.textContent = `${o.letter}. ${o.content}`;
          div.addEventListener('click', () => selectAnswer(o.letter, div));
          oEl.appendChild(div);
        });
      }

      function selectAnswer(letter, el) {
        // prevent double-click
        if (btn.disabled === false) return;
        const correct = answers[questions[idx].num];
        if (letter === correct) {
          el.classList.add('correct');
          correctCount++;
        } else {
          el.classList.add('wrong');
          // highlight the real correct one
          [...oEl.children].find(d => d.textContent.startsWith(correct + '.'))
                        .classList.add('correct');
        }
        btn.disabled = false;
      }

      btn.addEventListener('click', () => {
        idx++;
        if (idx < questions.length) {
          showQuestion();
        } else {
          document.getElementById('quiz-container').innerHTML =
            `<h1>Quiz Complete!</h1>
             <p>You answered <strong>${correctCount}</strong> out of <strong>${questions.length}</strong> correctly.</p>`;
        }
      });

      showQuestion();
    })();
  </script>
</body>
</html>